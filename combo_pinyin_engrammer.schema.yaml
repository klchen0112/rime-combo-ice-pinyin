# Rime schema
# encoding: utf-8

schema:
  schema_id: combo_pinyin_engrammer
  name: å®®ä¿æ‹¼éŸ³Engrammer
  version: '2.0'
  author:
    - å±…æˆæ° <chen.sst@gmail.com>
  description: |
    ä¸¦æ“Šè¼¸å…¥æ‹¼éŸ³
    https://github.com/rime/home/wiki/ComboPinyin

switches:
  - name: ascii_mode
    reset: 0
    states: [ ä¸­æ–‡, è¥¿æ–‡ ]
  - name: full_shape
    states: [ åŠè§’, å…¨è§’ ]
  - name: traditionalization
    states: [ ç®€, ç¹ ]
    reset: 0
  - name: ascii_punct
    states: [ ã€‚ï¼Œ, ï¼ï¼Œ ]
  - name: emoji
    states: [ ğŸ’€, ğŸ˜„ ]
    reset: 1

engine:
  processors:
    - ascii_composer
    - recognizer
    - chord_composer  # å¯¦ç¾ä¸¦æ“ŠæŒ‰éµè™•ç†
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - script_translator
  filters:
    - simplifier                                    # ç®€ç¹åˆ‡æ¢
    - simplifier@emoji                              # Emoji
    - uniquifier
#
# gt bfrvdecswxaqzhynjum ki,lo.p;''
# gt pzdbclfsczHXXRRRiuVaNIUeoEXS;QQ

chord_composer:
  use_control: true
  alphabet: ',''-aukeojiyxcbg.;/{Control_L}hlr tdmswfvnpqz'
  # æ‹¼å¯«é‹ç®—è¦å‰‡ï¼Œå°‡ä¸€çµ„ä¸¦æ“Šç·¨ç¢¼è½‰æ›çˆ²æ‹¼éŸ³éŸ³ç¯€
  algebra:
    # è‹¥ Control/Alt/Shift éµåƒèˆ‡ä¸¦æ“Šï¼Œé ˆæ”¹ä»¥å–®å€‹å­—ç¬¦è¡¨ç¤ºæŒ‰éµ
    - 'xform/\{Control_L\}/:/'
    - 'xform/\{Alt_L\}/:/'
    - 'xform/\{Shift_L\}/+/'
    # å°‡ç‰©ç†æŒ‰éµå­—ç¬¦å°æ‡‰åˆ°å®®ä¿æ‹¼éŸ³éµä½ä¸­çš„æ‹¼éŸ³å­—æ¯
    - 'xlit|,''-aukeojiyxcbg.;/hlr tdmswfvnpqz|gtpzdbclfsczHXXRRRiuVaNIUeoEXS;QQ|'
    # ä»¥ä¸‹æ ¹æ“šå®®ä¿æ‹¼éŸ³çš„éµä½åˆ†åˆ¥è®Šæ›è²æ¯ã€éŸ»æ¯éƒ¨åˆ†
    # å–®æ“Šæ™‚ç™¼é€æ¨™é»ç¬¦è™Ÿ
    - xform|^U$|,|
    - xform|^E$|.|
    # èˆ‡Shiftéµçµ„åˆæ™‚ç™¼é€æ¨™é»ç¬¦è™Ÿ
    - xform|^[+]U$|<|
    - xform|^[+]E$|>|
    # å¯é¸ï¼šå–®æ“Šæ™‚ç™¼é€æ¨™é»ç¬¦è™Ÿ
    #- xform|^S$|;|
    # åˆ†è™Ÿè¼ƒå°‘ç”¨ï¼Œæ”¹çˆ²é€šéçµ„åˆè¼¸å‡ºï¼ˆåƒ…ç•¶åˆ†è™Ÿéµç”¨ä½œ h éµæ™‚ï¼‰
    - 'xform/^[HX]S$|^S[XR]$/;/'
    # å·¦æ‰‹æ‹‡æŒ‡éµ h çˆ²åˆ†è™Ÿéµï¼Œè¡¨è¨˜çˆ² h
    - xlit|S|h|
    # å¯é¸ï¼šå–®æ“Šæ™‚ç™¼é€æ¨™é»ç¬¦è™Ÿ
    #- "xform|^Q$|'|"
    # å–®å¼•è™Ÿè¼ƒå°‘ç”¨ï¼Œæ”¹çˆ²é€šéçµ„åˆè¼¸å‡ºï¼ˆåƒ…ç•¶å–®å¼•è™Ÿéµç”¨ä½œ h éµæ™‚ï¼‰
    - 'xform/^[HX]Q$|^Q[XR]$/''/'
    # å·¦æ‰‹æ‹‡æŒ‡éµ h çˆ²å–®å¼•è™Ÿéµï¼Œè¡¨è¨˜çˆ² h
    - xlit|Q|h|
    # å·¦æ‰‹æ‹‡æŒ‡éµ h çˆ²ä¿®é£¾éµä¹‹ä¸€ï¼Œçµ±ä¸€è¡¨è¨˜çˆ² h
    - 'xlit|:+|hh|'
    # å¯é¸ï¼šå·¦æ‰‹æ‹‡æŒ‡éµ h åœ¨çµ„åˆä¸­ä½œâŸ¨hâŸ©ã€å–®æ“Šä½œç©ºæ ¼éµï¼Œæ–¹ä¾¿é›™æ‰‹äº¤æ›¿ä¸Šå­—
    #- 'xform/^h$/ /'
    # ç©ºæ ¼éµå–®æ“Šæ™‚ç™¼é€ç©ºç™½
    - 'xform/^a$/ /'
    # ç‰¹ä¾‹ï¼šä»¥çµ„åˆéµ[ae]è¼¸å…¥æ‹¼éŸ³âŸ¨aâŸ©
    - xform/^ae$/a/
    # âŸ¨erâŸ©è‡ªæˆéŸ³ç¯€
    - xform/^R$/er/
    # æ¶ˆé™¤ç„¡æ•ˆæŒ‰éµ
    - xform/[XR]+//
    # å°‡éµä½ hã€h' çµ±ä¸€è¡¨è¨˜çˆ² h
    - xform/Hh?/h/
    # çµ„åˆè²æ¯
    - xform/^bh/p/
    - xform/^dh/t/
    - xform/^gh/k/
    #- xform/^fh/v/
    - xform/^bf/m/
    - xform/^dl/n/
    - xform/^zc/r/
    # PCéµç›¤çµ„åˆè²æ¯
    - xform/^b[zcsh]+/p/
    - xform/^d[zcsh]+/t/
    - xform/^g[zcsh]+/k/
    - xform/^[zr][sh]+/zh/
    - xform/^csh/ch/
    # å…¼å®¹å¤§è¡†å¼
    - xform/^cs/sh/
    - xform/^lc/ch/
    - xform/^fz/zh/
    # æ¶ˆé™¤å¤šé¤˜çš„ h
    - xform/([^zcs])h/\1/

    # g,k,h æ¥ i/Ã¼ æ™‚ä½œ âŸ¨ji/ju, qi/qu, xi/xuâŸ©
    - xform/^[gz]([iV])/j$1/
    - xform/^[kc]([iV])/q$1/
    - xform/^[hs]([iV])/x$1/
    # ä¸Šæ’ä¸‰éµä¸¦æ“Š âŸ¨ong, uangâŸ©
    - xform/(ua?)Io$/$1Ne/
    - xform/aI$/ai/
    - xform/I[oe]$/ei/
    - xform/uI$/uei/
    # -i éµäº¦å¯ç”¨ä½œéŸ»æ¯ âŸ¨iâŸ©
    - xform/^gI$/ji/
    - xform/^kI$/qi/
    - xform/^hI$/xi/
    - xform/I$/i/
    # ä¸‹æ’ä¸‰éµä¸¦æ“Š âŸ¨iongâŸ©
    - xform/VUE$/VNe/
    # Ã¼ æ´»ç”¨çˆ²ä»‹éŸ³ âŸ¨iâŸ© ä»¥åˆ©æ–¼ä¸¦æ“Š âŸ¨iao, iouâŸ©
    - xform/V(a?)U$/i$1U/
    - xform/aU$/ao/
    - xform/UE?$/ou/
    - xform/aN?e$/ang/
    - xform/([iuV])Ne$/$1ng/
    # âŸ¨engâŸ© çœç•¥ âŸ¨eâŸ©
    - xform/Ne$/eng/
    - xform/^ung$/weng/
    - xform/ung$/ong/
    - xform/Vng$/iong/
    - xform/([aiuV])N$/$1n/
    # âŸ¨enâŸ© çœç•¥ âŸ¨eâŸ©
    - xform/N$/en/
    - xform/^un$/wen/
    # æ¼¢èªæ‹¼éŸ³æ–¹æ¡ˆçš„æ‹¼å¯«è¦å‰‡
    - xform/^i(ng?)$/yi$1/
    - xform/^i$/yi/
    - xform/^i/y/
    - xform/^u$/wu/
    - xform/^u/w/
    - xform/^V/yu/
    - xform/^([jqx])V/$1u/
    # ä¸€äº›å®¹éŒ¯
    - xform/^([zcsr]h?)i([aoe])/$1$2/
    - xform/^([zcsr]h?)i(ng?)$/$1e$2/
    # æ‹¼å¯«è¦å‰‡
    - xform/iou$/iu/
    - xform/uei$/ui/
    - xlit/VE/ve/
    # è²æ¯ç¨ç”¨æ™‚è£œè¶³éš å«çš„éŸ»æ¯
    # âŸ¨bu, pu, fuâŸ©
    - xform/^([bpf])$/$1u/
    # âŸ¨de, te, ne, le, ge, ke, heâŸ©ï¼Œç‰¹åˆ¥åœ°ï¼ŒâŸ¨meâŸ© å°æ‡‰å¸¸ç”¨å­—ã€Œéº¼Â·ä¹ˆã€
    - xform/^([mdtnlgkh])$/$1e/
    # âŸ¨zhi, chi, shi, ri, zi, ci siâŸ©ï¼ŒèˆŒå°–å…ƒéŸ³ç„¡é ˆæŒ‰éµï¼Œå°¤å…¶ z,c,s ä¸å¾—èˆ‡ i éµä¸¦æ“Š
    - xform/^([zcsr]h?)$/$1i/
  # ä¸¦æ“Šå®Œæˆå¾Œå¥—ç”¨çš„å¼æ¨£
  output_format:
    # è¿½åŠ éš”éŸ³ç¬¦è™Ÿ
    - "xform/^([bpm])([iu]|a|i?e|o|[ae]i|i?ao|[oi]u|i?an|[ie]n|[ei]ng|ang|ong)$/$1$2'/"
    - "xform/^([fw])(u|a|o|[ae]i|ao|ou|an|en|eng|ang|ong)$/$1$2'/"
    - "xform/^([dt])([iu]|i?a|i?e|uo|[aeu]i|i?ao|[oi]u|[iu]?an|[ue]n|[ei]ng|ang|ong)$/$1$2'/"
    - "xform/^([nl])([iuv]|i?a|[iv]?e|u?o|[aeu]i|i?ao|[oi]u|[iu]?an|[iue]n|[ei]ng|i?ang|ong)$/$1$2'/"
    - "xform/^([gkh])(u|u?a|e|uo|u?ai|[ue]i|ao|ou|u?an|[ue]n|eng|u?ang|ong)$/$1$2'/"
    - "xform/^([zcs]h?|r)([iu]|u?a|e|uo|u?ai|[ue]i|ao|ou|u?an|[ue]n|eng|u?ang|ong)$/$1$2'/"
    - "xform/^([jqxy])([iu]|i?a|[iu]?e|o|i?ao|[oi]u|[iu]?an|[iu]n|ing|i?ang|i?ong)$/$1$2'/"
    - "xform/^([aeo]|[ae]i|ao|ou|[ae]ng?|er)$/$1'/"
    # æ¶ˆé™¤ä¸æ§‹æˆåˆæ³•éŸ³ç¯€çš„ä¸¦æ“Šçµ„åˆ
    - "erase/^([A-Za-z]+)$/"
  # ä¸¦æ“Šéç¨‹ä¸­å¥—ç”¨çš„å¼æ¨£
  prompt_format:
    # åŠ æ–¹æ‹¬å¼§
    - 'xform/^(.*)$/[$1]/'

editor:
  bindings:
    BackSpace: back_syllable

speller:
  alphabet: "zyxwvutsrqponmlkjihgfedcba'"
  initials: "zyxwvutsrqponmlkjihgfedcba"
  delimiter: " "
  algebra:
    # æ‹¼éŸ³éŸ³ç¯€ä¸€å¾‹å¾ŒåŠ éš”éŸ³ç¬¦è™Ÿï¼Œé¿å…éŸ³ç¯€åˆ‡åˆ†æ­§ç¾©
    - "xform/^([a-z]+)$/$1'/"

translator:
  dictionary: combo_pinyin
  prism: combo_pinyin_engrammer
  preedit_format:
    - xform/([nl])v/$1Ã¼/
    - xform/([nl])ue/$1Ã¼e/
    - xform/([jqxy])v/$1u/
    - "xform/' /'/"

punctuator:
  import_preset: default

key_binder:
  import_preset: default

recognizer:
  import_preset: default

# Emoji
emoji:
  option_name: emoji
  opencc_config: emoji.json

# ç®€ç¹åˆ‡æ¢
traditionalize:
  option_name: traditionalization
  opencc_config: s2t.json  # s2t.json | s2hk.json | s2tw.json | s2twp.json
  tips: none               # è½¬æ¢æç¤º: all éƒ½æ˜¾ç¤º | char ä»…å•å­—æ˜¾ç¤º | none ä¸æ˜¾ç¤ºã€‚
  tags: [ abc, number, gregorian_to_lunar ]  # é™åˆ¶åœ¨å¯¹åº” tagï¼Œä¸å¯¹å…¶ä»–å¦‚åæŸ¥çš„å†…å®¹åšç®€ç¹è½¬æ¢


__patch:
  # ä½¿ç”¨å…«è‚¡æ–‡èªè¨€æ¨¡å‹
  - grammar:/hans?
